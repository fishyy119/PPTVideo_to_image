# PPTVideo_to_image
## 关于功能
本程序通过将视频各帧进行提取，使用感知哈希算法计算图片相似度，最终将视频各个不相似帧提取为图片输出。
   
### 在基本功能的基础上，本程序还提供了以下功能：
1. 指定输入视频的某一个片段，仅针对此片段进行处理
2. 在控制台进行日志输出，提示处理进度
  
### 本程序提供了以下的自定义参数：
1. 输入视频文件
2. 输出文件夹
3. 目标视频片段起点时刻
4. 目标视频片段终点时刻
5. 跳帧幅度
    > 考虑到PPT视频具有大量连续重复帧，其持续时间大多数情况下以秒或分钟计，本程序默认每30帧一读取，大多数情况下不会有丢页情况。  
    > >考虑到实际情况，跳帧幅度也可调整为更大  
    > >对于某些特殊的快速翻页片段，也可使用更小的跳帧幅度进行二次提取
6. 进度提示间隔
7. 相似度比较阈值
    > 此值越小，则对于图片相似度的判断越严格  
    > 当此项为0时，所有截取到的帧都会被输出，相似图片判断失效  
    > 当此项为1时，相似度判断最为严格，
    > >在此项为1时，可能会出现一页ppt重复输出的现象，但是对于带有动画的视频不会有漏帧的现象（即两页PPT的中间动画状态被输出的同时，第二页PPT由于与中间状态相似而没有被输出，对于使用了淡入淡出动画的PPT影响尤为明显）

## 关于版本差异
本程序尝试使用了两个库（**OpenCV**与**MoviePy**）分别对功能进行实现，其在具体性能上具有差异。  
  
其中**OpenCV**实现的版本，在大幅度跳帧时，相较于moviepy版本表现出了明显的速度优势，
在**30帧**一跳的情况下，处理速度约为**MoviePy**实现版本的7倍以上。  
  
在跳帧幅度小的情况下，**MoviePy**实现的版本可能表现出比opencv版本更优的时间性能，
在**2帧**一跳的情况下，处理速度约为**MoviePy**版本的2.5倍。

> 上文所提到数据仅为估算，未多次试验加以验证，仅供参考。

对于跳帧幅度参数的变化，**OpenCV**版本表现出高度的敏感性，减小跳帧幅度显著增加了程序的处理时间。  
  
同时，**MoviePy**版本表现出较弱的敏感性，更改跳帧幅度没有使得程序处理时间表现出预想中的大幅度变化。
